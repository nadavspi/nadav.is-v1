/*!
* FitVids 1.0.3
*
* Copyright 2013, Chris Coyier - http://css-tricks.com + Dave Rupert - http://daverupert.com
* Credit to Thierry Koblentz - http://www.alistapart.com/articles/creating-intrinsic-ratios-for-video/
* Released under the WTFPL license - http://sam.zoy.org/wtfpl/
*
* Date: Thu Sept 01 18:00:00 2011 -0500
*/
!function(t){"use strict";t.fn.fitVids=function(e){var o={customSelector:null};if(!document.getElementById("fit-vids-style")){var n=document.createElement("div"),a=document.getElementsByTagName("base")[0]||document.getElementsByTagName("script")[0],i="&shy;<style>.fluid-width-video-wrapper{width:100%;position:relative;padding:0;}.fluid-width-video-wrapper iframe,.fluid-width-video-wrapper object,.fluid-width-video-wrapper embed {position:absolute;top:0;left:0;width:100%;height:100%;}</style>";n.className="fit-vids-style",n.id="fit-vids-style",n.style.display="none",n.innerHTML=i,a.parentNode.insertBefore(n,a)}return e&&t.extend(o,e),this.each(function(){var e=["iframe[src*='player.vimeo.com']","iframe[src*='youtube.com']","iframe[src*='youtube-nocookie.com']","iframe[src*='kickstarter.com'][src*='video.html']","object","embed"];o.customSelector&&e.push(o.customSelector);var n=t(this).find(e.join(","));n=n.not("object object"),n.each(function(){var e=t(this);if(!("embed"===this.tagName.toLowerCase()&&e.parent("object").length||e.parent(".fluid-width-video-wrapper").length)){var o="object"===this.tagName.toLowerCase()||e.attr("height")&&!isNaN(parseInt(e.attr("height"),10))?parseInt(e.attr("height"),10):e.height(),n=isNaN(parseInt(e.attr("width"),10))?e.width():parseInt(e.attr("width"),10),a=o/n;if(!e.attr("id")){var i="fitvid"+Math.floor(999999*Math.random());e.attr("id",i)}e.wrap('<div class="fluid-width-video-wrapper"></div>').parent(".fluid-width-video-wrapper").css("padding-top",100*a+"%"),e.removeAttr("height").removeAttr("width")}})})}}(window.jQuery||window.Zepto),function(t){t.bigfoot=function(e){function o(e,o){var n,a,i,r;e.each(function(){var e=t(this);i="#"+e.attr("href").split("#")[1],n=e.closest("sup"),a=e.find("sup"),n.length>0?(r=(n.attr("id")||"")+(e.attr("id")||""),o.push(n.attr({"data-footnote-backlink-ref":r,"data-footnote-ref":i}))):a.length>0?(r=(a.attr("id")||"")+(e.attr("id")||""),o.push(e.attr({"data-footnote-backlink-ref":r,"data-footnote-ref":i}))):(r=e.attr("id")||"",o.push(e.attr({"data-footnote-backlink-ref":r,"data-footnote-ref":i})))})}function n(t){if(t.is(":empty")||0==t.children(":not(.hidden)").length){var e=t.parent();"delete"===d.actionOriginalFN.toLowerCase()?t.remove():t.addClass("hidden").css({display:"none"}),n(e)}else if(t.children(":not(.hidden)").length==t.children("hr:not(.hidden)").length){var e=t.parent();"delete"===d.actionOriginalFN.toLowerCase()?t.remove():(t.children("hr").addClass("hidden").css({display:"none"}),t.addClass("hidden").css({display:"none"})),n(e)}}function a(t,e){e.indexOf(" ")>=0&&(e=e.trim().replace(/ +/g,"|").replace(/(.*)/g,"($1)"));var o="(s|&nbsp;)*<s*a[^#<]*#"+e+"[^>]*>(.*?)<s*/s*a>",n=new RegExp(o,"g");return t.replace(n,"").replace("[]","")}function i(t,e,o){for(var n,a,i=new RegExp("{{"+e+":([^}]*)}}","g");n=i.exec(t);)n[1]&&(a=o.attr(n[1])||"",t=t.replace("{{"+e+":"+n[1]+"}}",a));return t}function r(e,o){return e=e||".footnote-content",o=o||d.popoverDeleteDelay,t(e).each(function(){var e=t('.footnote-button[data-footnote-identifier="'+t(this).attr("data-footnote-identifier")+'"]'),n=t(this);e.hasClass("changing")||(e.removeClass("active hover-instantiated click-instantiated").addClass("changing"),n.removeClass("active").addClass("disapearing"),setTimeout(function(){n.remove(),e.removeClass("changing")},o))}),t(e.replace(".footnote-content",".footnote-button"))}function s(t,e){e=e||.5;var o=t.find(".tooltip");o.length>0&&o.css({left:100*e+"%"})}function l(e){var o=parseFloat(e.outerWidth()),n=parseFloat(e.outerHeight()),a=c(),i=e.offset().top-t(window).scrollTop()+n/2,r=e.offset().left+o/2;return{topRoom:i,bottomRoom:a.height-i,leftRoom:r,rightRoom:a.width-r,leftRelative:r/a.width,topRelative:i/a.height}}function c(){var t=document.createElement("div");t.style.cssText="position: fixed;top: 0;left: 0;bottom: 0;right: 0;",document.documentElement.insertBefore(t,document.documentElement.firstChild);var e={width:t.offsetWidth,height:t.offsetHeight};return document.documentElement.removeChild(t),e}var d=t.extend({actionOriginalFN:"hide",activateOnHover:!1,allowMultipleFN:!1,appendPopoversTo:void 0,deleteOnUnhover:!1,hoverDelay:250,popoverDeleteDelay:500,popoverCreateDelay:100,positionNextToBlock:!0,positionContent:!0,preventPageScroll:!0,scope:!1,contentMarkup:'<aside class="footnote-content bottom"data-footnote-identifier="{{FOOTNOTENUM}}" alt="Footnote {{FOOTNOTENUM}}"><div class="footnote-main-wrapper"><div class="footnote-content-wrapper">{{FOOTNOTECONTENT}}</div></div><div class="tooltip"></div></aside>',buttonMarkup:'<a href="#" class="footnote-button" data-footnote-identifier="{{FOOTNOTENUM}}" alt="See Footnote {{FOOTNOTENUM}}" rel="footnote"data-footnote-content="{{FOOTNOTECONTENT}}"><span class="footnote-circle" data-footnote-identifier="{{FOOTNOTENUM}}"></span><span class="footnote-circle"></span><span class="footnote-circle"></span></a>'},e),f=function(){var e;e=d.scope?d.scope+' a[href*="#"]':'a[href*="#"]';var r,s=t(e).filter(function(){var e=t(this),o=e.attr("rel")||"";return(e.attr("href")+o).match(/(fn|footnote|note)/gi)&&e.closest("[class*=footnote]:not(a):not(sup)").length<1}),l=[],c=[];o(s,c),t(c).each(function(){r=t(this).attr("data-footnote-ref").replace(":","\\:"),l.push(t(r).closest("li"))});for(var f=0;f<l.length;f++){var p,u=a(t(l[f]).html().trim(),t(c[f]).data("footnote-backlink-ref")).replace(/"/g,"&quot;").replace(/&lt;/g,"&ltsym;").replace(/&gt;/g,"&gtsym;"),h=+(f+1),v="";0!==u.indexOf("<")&&(u="<p>"+u+"</p>"),v=d.buttonMarkup.replace(/\{\{FOOTNOTENUM\}\}/g,h).replace(/\{\{FOOTNOTECONTENT\}\}/g,u),v=i(v,"SUP",t(c[f])),v=i(v,"FN",t(l[f])),p=t(v).insertAfter(t(c[f])),t(c[f]).remove();var m=t(l[f]).parent();switch(d.actionOriginalFN.toLowerCase()){case"delete":t(l[f]).remove(),n(m);break;case"hide":t(l[f]).addClass("hidden").css({display:"none"}),n(m)}}},p=function(e){if(d.activateOnHover){var o=t(e.target).closest(".footnote-button"),n='[data-footnote-identifier="'+o.attr("data-footnote-identifier")+'"]';if(o.hasClass("active"))return;if(o.addClass("hover-instantiated"),!d.allowMultipleFN){var a=".footnote-content:not("+n+")";r(a)}v(".footnote-button"+n).addClass("hover-instantiated")}},u=function(e){var o=t(e.target),n=o.closest(".footnote-button");$nearFootnote=o.closest(".footnote-content"),n.length>0?(e.preventDefault(),h(n)):$nearFootnote.length<1&&t(".footnote-content").length>0&&r()},h=function(t){t.blur();var e='data-footnote-identifier="'+t.attr("data-footnote-identifier")+'"';t.hasClass("changing")||(t.hasClass("active")?d.allowMultipleFN?r(".footnote-content["+e+"]"):r():(t.addClass("changing"),setTimeout(function(){t.removeClass("changing")},d.popoverCreateDelay),v(".footnote-button["+e+"]"),t.addClass("click-instantiated"),d.allowMultipleFN||r(".footnote-content:not(["+e+"])")))},v=function(e){if(e=e||".footnote-button",d.allowMultipleFN)var o=t(e).closest(".footnote-button");else var o=t(e+":first").closest(".footnote-button");o.each(function(){var e=t(this);try{var o=d.contentMarkup.replace(/\{\{FOOTNOTENUM\}\}/g,e.attr("data-footnote-identifier")).replace(/\{\{FOOTNOTECONTENT\}\}/g,e.attr("data-footnote-content").replace(/&gtsym;/,"&gt;").replace(/&ltsym;/,"&lt;"));o=i(o,"BUTTON",e)}finally{d.appendPopoversTo?$content=t(o).appendTo(d.appendPopoversTo+":first"):($nearestBlock=e.closest("p, div, pre, li, ul, section, article, main, aside"),$siblingFootnote=$nearestBlock.siblings(".footnote-content:last"),$content=$siblingFootnote.length>0?t(o).insertAfter($siblingFootnote):t(o).insertAfter($nearestBlock)),$content.attr("data-bigfoot-max-height",$content.height()),b(),e.addClass("active"),$content.find(".footnote-content-wrapper").bindScrollHandler()}});var n=t(e.replace(".footnote-button",".footnote-content"));return setTimeout(function(){n.addClass("active")},d.popoverCreateDelay),n};t.fn.bindScrollHandler=function(){d.preventPageScroll&&t(this).on("DOMMouseScroll mousewheel",function(e){var o=t(this),n=o.scrollTop(),a=o[0].scrollHeight,i=parseInt(o.css("height")),r=o.closest(".footnote-content");if(o.scrollTop()>0&&o.scrollTop()<10&&r.addClass("scrollable"),r.hasClass("scrollable")){var s="DOMMouseScroll"==e.type?-40*e.originalEvent.detail:e.originalEvent.wheelDelta,l=s>0,c=function(){return e.stopPropagation(),e.preventDefault(),e.returnValue=!1,!1};return!l&&-s>a-i-n?(o.scrollTop(a),r.addClass("fully-scrolled"),c()):l&&s>n?(o.scrollTop(0),r.removeClass("fully-scrolled"),c()):(r.removeClass("fully-scrolled"),void 0)}})};var m=function(e){d.deleteOnUnhover&&d.activateOnHover&&setTimeout(function(){t(e.target).closest(".footnote-content, .footnote-button"),t(".footnote-button:hover, .footnote-content:hover").length<1&&r()},d.hoverDelay)},g=function(t){27==t.keyCode&&r()},b=function(){d.positionContent&&t(".footnote-content").each(function(){var e=t(this),o='data-footnote-identifier="'+e.attr("data-footnote-identifier")+'"',n=(e.find(".footnote-content-wrapper"),t(".footnote-button["+o+"]")),a=l(n),i=parseFloat(e.css("width")),r=parseFloat(e.css("margin-top")),c=+e.attr("data-bigfoot-max-height"),d=2*r+c,f=1e4;a.bottomRoom<d&&a.topRoom>a.bottomRoom?(e.css({top:"auto",bottom:a.bottomRoom+"px"}).addClass("top").removeClass("bottom"),f=a.topRoom-r-15,e.css({"transform-origin":100*a.leftRelative+"% 100%"})):(e.css({bottom:"auto",top:a.topRoom+"px"}).addClass("bottom").removeClass("top"),f=a.bottomRoom-r-15,e.css({"transform-origin":100*a.leftRelative+"% 0%"})),e.find(".footnote-content-wrapper").css({"max-height":Math.min(f,c)+"px"}),e.css({left:a.leftRoom-a.leftRelative*i+"px"}),s(e,a.leftRelative),parseInt(e.css("height"))<e.find(".footnote-content-wrapper")[0].scrollHeight&&e.addClass("scrollable")})},w=function(t,e){var o=d[t];return d[t]=e,o},O=function(t){return d[t]};return t(document).ready(function(){f(),t(document).on("mouseenter",".footnote-button",p),t(document).on("touchend click",u),t(document).on("mouseout",".hover-instantiated",m),t(document).on("keyup",g),t(window).on("scroll resize",b)}),{close:function(t,e){return r(t,e)},activate:function(t){return v(t)},reposition:function(){return b()},getSetting:function(t){return O(t)},updateSetting:function(t,e){return w(t,e)}}}}(jQuery),$(".fitvids").fitVids(),$.bigfoot(),$(".portfolio__toggle").click(function(t){t.preventDefault();var e=$(this).next(".portfolio__preview"),o=e.find(".portfolio__preview__iframe");e.toggleClass("portfolio__preview--visible"),e.hasClass("portfolio__preview--visible")&&o.attr("src",o.data("src"))});